<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pro Tracker 1.0</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <div class="page">
    <h1>Pro Tracker 1.0</h1>

    <form class="toolbar" method="get" action="/">
      <input type="text" name="players" placeholder="多个玩家，逗号分隔"
             value="{{ players_str }}" />
      <select name="limit">
        {% for n in [5,10,15,20] %}
          <option value="{{n}}" {% if n == limit %}selected{% endif %}>每人 {{n}} 场</option>
        {% endfor %}
      </select>
      <button type="submit">刷新数据</button>
    </form>

    <p class="tip">
      提示：Match 点击跳转 Faceit 比赛页下载 Demo；胜负自动上色；时间为选手的本地时间；一行最多显示 5 列。
    </p>

    <div class="grid">
      {% for c in cards %}
        <div class="card">
          <div class="card__title">
            <span class="nick">{{ c.nickname }}</span>
            <a class="faceit" href="{{ c.faceit_url }}" target="_blank">Faceit</a>
          </div>

          <table class="table">
            <thead>
              <tr>
                <th>Date</th>
                <th class="score">Score</th>
                <th>Map</th>
                <th>K / A / D</th>
                <th class="rating">Rating</th>
              </tr>
            </thead>
            <tbody>
            {% for m in c.matches %}
              <tr class="{% if m.penta|int >= 1 %}hl{% endif %}">
                <td class="date">
                  <a class="match" href="{{ m.faceit_match }}" target="_blank"
                    title="打开 Faceit 比赛页">{{ m.time_text }}</a>
                </td>
                <td class="score">
                  <span class="pill {% if m.result == 'Win' %}win{% else %}loss{% endif %}">
                    {{ m.score }}
                  </span>
                </td>
                <td class="map">
                  <img src="{{ m.map_img }}" alt="{{ m.map }}" />
                  <span>{{ m.map }}</span>
                </td>
                <td class="kad">{{ m.k }} / {{ m.a }} / {{ m.d }}</td>
                <td class="rating">
                  {% if m.rating and m.rating != '-' %}
                    {{ m.rating }}
                  {% else %}
                    -
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
      {% endfor %}
    </div>
  </div>
</body>
</html>
